<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Сайт Владимира Тихомирова</title>
<link rel="stylesheet" href="style.css" type="text/css">
<script language="JavaScript">
<!--
function mmLoadMenus() {
  if (window.mm_menu_0803092855_0) return;
      window.mm_menu_0803092855_0 = new Menu("root",203,18,"Courier New, Courier, monospace",12,"#003333","#009966","#FCFAF9","#000099","center","middle",3,0,500,-5,7,true,true,true,0,true,true);
  mm_menu_0803092855_0.addMenuItem("Java","location='java.html'");
  mm_menu_0803092855_0.addMenuItem("JavaScript","location='js.html'");
  mm_menu_0803092855_0.addMenuItem("Cемиструнная&nbsp;гитара","location='guitar.html'");
  mm_menu_0803092855_0.addMenuItem("Web-программирование","location='web_proga.html'");
  mm_menu_0803092855_0.addMenuItem("Велосипед","location='bike.html'");
  mm_menu_0803092855_0.addMenuItem("Коньки&nbsp;и&nbsp;ролики","location='roller.html'");
  mm_menu_0803092855_0.addMenuItem("Математика","location='maths.html'");
  mm_menu_0803092855_0.addMenuItem("Моя&nbsp;группа","location='111.html'");
   mm_menu_0803092855_0.hideOnMouseOut=true;
   mm_menu_0803092855_0.bgColor='#000099';
   mm_menu_0803092855_0.menuBorder=1;
   mm_menu_0803092855_0.menuLiteBgColor='#99FF00';
   mm_menu_0803092855_0.menuBorderBgColor='#777777';
    window.mm_menu_0803103406_0_1 = new Menu("2008",142,18,"Courier New, Courier, monospace",12,"#003333","#009966","#FCFAF9","#000099","center","middle",3,0,500,-5,7,true,true,true,0,true,true);
    mm_menu_0803103406_0_1.addMenuItem("Одесса","location='Odeca.html'");
    mm_menu_0803103406_0_1.addMenuItem("Поход&nbsp;по&nbsp;Крыму","location='pohod.html'");
     mm_menu_0803103406_0_1.hideOnMouseOut=true;
     mm_menu_0803103406_0_1.bgColor='#3300FF';
     mm_menu_0803103406_0_1.menuBorder=1;
     mm_menu_0803103406_0_1.menuLiteBgColor='#99FF00';
     mm_menu_0803103406_0_1.menuBorderBgColor='#777777';
  window.mm_menu_0803103406_0 = new Menu("root",60,18,"Courier New, Courier, monospace",12,"#003333","#009966","#FCFAF9","#000099","center","middle",3,0,500,-5,7,true,true,true,0,true,true);
  mm_menu_0803103406_0.addMenuItem(mm_menu_0803103406_0_1);
   mm_menu_0803103406_0.hideOnMouseOut=true;
   mm_menu_0803103406_0.childMenuIcon="arrows.gif";
   mm_menu_0803103406_0.bgColor='#3300FF';
   mm_menu_0803103406_0.menuBorder=1;
   mm_menu_0803103406_0.menuLiteBgColor='#99FF00';
   mm_menu_0803103406_0.menuBorderBgColor='#777777';

mm_menu_0803103406_0.writeMenus();
} // mmLoadMenus()
//-->
</script>
<script language="JavaScript" src="mm_menu.js"></script>
<style type="text/css">
<!--
.style1 {
	color: #990033;
	font-style: italic;
}
-->
</style>
</head>
<body bgcolor="wheat">
<script language="JavaScript1.2">mmLoadMenus();</script>
<table class="T1" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td width="194"><a href="foto/1_b_index.jpg" tardet="big"><img src="foto/1_index.jpg" width="192" height="184" border="1" alt="" title="bigger"></a></td>
    <td valign="top"><marquee bgcolor="lightsalmon" direction="right" width="100%" style="border: solid 1px black; border-left:none; ">
      Если быть, то быть лучшим!
      </marquee>
        <div class="s1" valign="bottom">
          <marquee behavior="slide" style="border: solid 1px black; border-left:none; border-top:none; border-bottom:none;">
          <a href="foto/02_b.jpg"><img src="foto/02.jpg" width="161" height="87" border="0" alt="" title="BIGGER!!!"></a>
          </marquee>
        </div>
      <table background="foto/03.jpg" width="100%" height="69" class="s2" align="center" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td onMouseOver="this.style.color='black';" onMouseOut="this.style.color='yellow';" onClick="javascript:alert('ERROR!!!Your computer may be at a risk! Please, restart.')"> С ДЕВУШКАМИ НЕ СПОРЯТ!!!</td>
          </tr>
      </table></td>
  </tr>
  <tr>
    <td valign="top" width="192"><TABLE class="T2" cellpadding="0" cellspacing="0" >
      <ul>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" onClick="window.location.href ='index.html' "><li><a href="index.html">Главная</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" onClick="window.location.href ='friends.html' "><li><a href="friends.html">Друзья</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';"><li><a href="#" name="link5" id="link1" onMouseOver="MM_showMenu(window.mm_menu_0803092855_0,59,0,null,'link5')" onMouseOut="MM_startTimeout();">Обучение</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" ><li><a href="#" name="link2" id="link3" onMouseOver="MM_showMenu(window.mm_menu_0803103406_0,74,13,null,'link2')" onMouseOut="MM_startTimeout();">Фотогалерея</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" onClick="window.location.href ='music.html' "><li><a href="music.html">Музыка</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" onClick="window.location.href ='idea.html' "><li><a href="idea.html">Идеология</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" onClick="window.location.href ='funny.html' "><li><a href="funny.html">Юмор</a></li></td>
        </tr>
        <tr>
          <td onMouseOver="this.style.color='white'; this.style.background='lightgrey';" onMouseOut="this.style.background='cornsilk'; this.style.color='black';" onClick="window.location.href ='contact.html' "><li><a href="contact.html">Контактная  информация</a></li></td>
        </tr>
      </ul>
    </TABLE>
	<div class="cl4" style="margin-top:50;" align="center">друзья сайта:<br><a href="http://www.mathliga56.narod.ru">mathliga56.narod.ru</a></div>
			<div class="cl5" style="margin-top:50;" align="center">советую посетить:<br>
			<a href="http://forum.vingrad.ru/">forum.vingrad.ru</a><br>
			<a href="http://www.securitylab.ru/">securitylab.ru</a><br>
			<a href="http://free-lib.ru/">free-lib.ru</a><br></div>
			<div align="center" style="font-size:13px; margin-top:135;" >разработчик<br>&copy; <a href="http://vkontakte.ru/profile.php?id=62950">Vladimir Tikhomirov</a></div>
	</td>
<td valign="top" style="border: solid 1px black;">
<h3 align="center">JAVA - язык высокого уровня</h3>
<hr align="center" width="60%" color="#009933"/>
<b>class EditRoute.java</b>
<pre style="margin-left:20;">
package view;

import java.awt.Color;
import java.awt.Container;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JTextField;
import model.Data;
import model.data.Station;
import model.data.Train;
import model.exceptions.TrainException;
/**
 *
 * @author Vladimir
 */
public class EditRoute implements ActionListener{
    private Container contentTextfields;
    private Train train;
    private String Name;
    private String editName;
    private JComboBox comboBoxStation;
    private JComboBox comboBoxTrain;
    private JTextField nameStationTextField;
    private JTextField timeComeTextField;
    private String editTimeCome;
    private String editTimeOut;
    private Station[] massivStations;
    private String[] massivNames;
    private JLabel station;
    private JLabel nameStationLabel;
    private JLabel editStationLabel;            
    private JLabel timeComeLabel;            
    private JLabel timeOutLabel;
    private JTextField timeOutTextField;
    private JLabel chooseTrain;
    private JLabel numberWayLabel;
    private JComboBox comboBoxWays;
    private int[] massivWays;
    private String wayTrain; //way where the train is
    private int chooseIndex; //number of current station
    public EditRoute(Data currentData){
        try {
            contentTextfields = new Container();
            contentTextfields.setLayout(new GridLayout(0, 2));

            train = currentData.search(113);            
            train.changeSt(15, "Станция1", 2, 125);
                      
            massivStations = currentData.getListStations();
            //=======
            massivWays = new int[massivStations.length];  //count of ways of each station 
            for(int i=0; i<massivStations.length; i++){
                massivWays[i] = massivStations[i].getPosTrains();
            }
            //=============
            massivNames = currentData.getListStationsNames();
          
            Train[] massivTrains = currentData.getTrains();
            int[] massivNumberTrain = new int[massivTrains.length];
            String[] massivForComboBox = new String[massivNumberTrain.length];
            for(int i=0; i<massivTrains.length; i++){
                massivNumberTrain[i] = massivTrains[i].getCur();
                massivForComboBox[i] = ""+massivNumberTrain[i];
            }          
            comboBoxTrain = new JComboBox(massivForComboBox);
            comboBoxTrain.setSelectedIndex(0);
            comboBoxTrain.setBackground(Color.WHITE);
          
            comboBoxStation = new JComboBox(massivNames);
            comboBoxStation.setSelectedIndex(0);
            comboBoxStation.setBackground(Color.WHITE);
            comboBoxStation.addActionListener(this);   
        
            editName = massivStations[0].getName();
            Name = editName;
            int time1 = train.getStTime(0).arrival;
            int time2 = train.getStTime(0).departure;
            editTimeCome = minutToHoursAndMinut(time1);
            editTimeOut = minutToHoursAndMinut(time2);
            //========================
            int c = massivWays[0];
            String[] massivStringWays = new String[c];
            for(int i=0; i<c; i++){
                massivStringWays[i] = (i+1)+"";
            }
            comboBoxWays = new JComboBox(massivStringWays);
            comboBoxWays.setSelectedIndex(0);
            comboBoxWays.setBackground(Color.WHITE);
            comboBoxWays.addActionListener(new ActionListener()
            {
                public void actionPerformed(ActionEvent event)
                {
                    wayTrain = (String) comboBoxWays.getSelectedItem();
                    System.out.println(wayTrain);
                }
            });
                      //=======================
            chooseTrain = new JLabel("Выбрать поезд: ");
            station = new JLabel("Выбрать станцию: ");
            nameStationLabel = new JLabel(Name);
            editStationLabel = new JLabel("Название станции: ");
            nameStationTextField = new JTextField(editName, 15);
            nameStationTextField.setEditable(false);
            timeComeLabel = new JLabel("Изменить время прибытия: ");
            timeComeTextField = new JTextField(editTimeCome, 15);
            //обработка события редактирование времени прибытия поезда
            timeComeTextField.addActionListener(new ActionListener()
            {
                public void actionPerformed(ActionEvent event)
                {
                    try {
                        int newTimeCome = 0;
                        String newTime1 = (String) timeComeTextField.getText();
                        if (newTime1.length() < 6) {
                            for (int i = 0; i < newTime1.length(); i++) {
                                if (newTime1.length() == 4) {
                                    if (find(newTime1.substring(i, i + 1)) && checkTheForthSymbol(newTime1.substring(2, 3)) && checkTheThirdSymbol(newTime1.substring(1, 2))) {
                                        timeComeTextField.setForeground(Color.BLACK);
                                        timeComeTextField.setBackground(Color.WHITE);
                                    } else {
                                        timeComeTextField.setForeground(Color.WHITE);
                                        timeComeTextField.setBackground(Color.RED);
                                        timeComeTextField.setText("некорректные символы1");
                                    }
                                }
                                if (newTime1.length() == 5) {
                                    if (checkTheFirstSymbol(newTime1.substring(0, 1)) && find(newTime1.substring(i, i + 1)) && checkTheForthSymbol(newTime1.substring(3, 4)) && checkTheThirdSymbol(newTime1.substring(2, 3))) {
                                        timeComeTextField.setForeground(Color.BLACK);
                                        timeComeTextField.setBackground(Color.WHITE);
                                    } else {
                                        timeComeTextField.setForeground(Color.WHITE);
                                        timeComeTextField.setBackground(Color.RED);
                                        timeComeTextField.setText("некорректные символы2");
                                    }
                                }
                            }
                            newTime1 = (String) timeComeTextField.getText();
                            System.out.println("newTime1superNew = " + newTime1);
                        } else {
                            timeComeTextField.setForeground(Color.WHITE);
                            timeComeTextField.setBackground(Color.BLUE);
                            timeComeTextField.setText("слишком много символов");
                        }
                        newTimeCome = hoursAndMinutToMinutes(newTime1);
                        train.getStTime(chooseIndex).arrival = newTimeCome;
                        
                        System.out.println("arrival = "+train.getStTime(chooseIndex).arrival);
                    } catch (TrainException ex) {
                        Logger.getLogger(EditRoute.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            });
            timeOutLabel = new JLabel("Изменить время отъезда: ");
            timeOutTextField = new JTextField(editTimeOut, 15);
            //обработка события редактирования времени отъезда поезда 
            timeOutTextField.addActionListener(new ActionListener()
            {
                public void actionPerformed(ActionEvent event)
                {
                    try {
                        int newTimeOut = 0;
                        String newTime2 = (String) timeOutTextField.getText();
                        if (newTime2.length() < 6) {
                            for (int i = 0; i < newTime2.length(); i++) {
                                if (newTime2.length() == 4) {
                                    if (find(newTime2.substring(i, i + 1)) && checkTheForthSymbol(newTime2.substring(2, 3)) && checkTheThirdSymbol(newTime2.substring(1, 2))) {
                                        timeOutTextField.setForeground(Color.BLACK);
                                        timeOutTextField.setBackground(Color.WHITE);
                                    } else {
                                        timeOutTextField.setForeground(Color.WHITE);
                                        timeOutTextField.setBackground(Color.RED);
                                        timeOutTextField.setText("некорректные символы1");
                                    }
                                }
                                if (newTime2.length() == 5) {
                                    if (checkTheFirstSymbol(newTime2.substring(0, 1)) && find(newTime2.substring(i, i + 1)) && checkTheForthSymbol(newTime2.substring(3, 4)) && checkTheThirdSymbol(newTime2.substring(2, 3))) {
                                        timeOutTextField.setForeground(Color.BLACK);
                                        timeOutTextField.setBackground(Color.WHITE);
                                    } else {
                                        timeOutTextField.setForeground(Color.WHITE);
                                        timeOutTextField.setBackground(Color.RED);
                                        timeOutTextField.setText("некорректные символы2");
                                    }
                                }
                            }
                            newTime2 = (String) timeComeTextField.getText();
                            System.out.println("newTime2superNew = " + newTime2);
                        } else {
                            timeComeTextField.setForeground(Color.WHITE);
                            timeComeTextField.setBackground(Color.BLUE);
                            timeComeTextField.setText("слишком много символов");
                        }
                        newTimeOut = hoursAndMinutToMinutes(newTime2);
                        train.getStTime(chooseIndex).departure = newTimeOut;
                        
                        System.out.println("departure = "+train.getStTime(chooseIndex).departure);
                    } catch (TrainException ex) {
                        Logger.getLogger(EditRoute.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            });
            numberWayLabel = new JLabel("Изменить путь: "); 
                
            contentTextfields.add(chooseTrain);
            contentTextfields.add(comboBoxTrain);
            contentTextfields.add(station);
            contentTextfields.add(comboBoxStation);
            contentTextfields.add(editStationLabel);
            contentTextfields.add(nameStationTextField);
            contentTextfields.add(timeComeLabel);
            contentTextfields.add(timeComeTextField);
            contentTextfields.add(timeOutLabel);
            contentTextfields.add(timeOutTextField);    
            contentTextfields.add(numberWayLabel);
            contentTextfields.add(comboBoxWays); 
    
            start();
        } catch (TrainException ex) {
            Logger.getLogger(EditRoute.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    void start(){
        Alert alert = new Alert(null,Alert.OK_CANCEL_OPTION,Alert.PLAIN_MESSAGE,contentTextfields, "Редактирование маршрута");
    }
    //обработка события выбора станции
    public void actionPerformed(ActionEvent e) {
        try {
            JComboBox cb = (JComboBox) e.getSource();
            String chooseStation = (String) cb.getSelectedItem();
            chooseIndex = cb.getSelectedIndex();

            editName = chooseStation;
            int timeIn = train.getStTime(chooseIndex).arrival;
            editTimeCome = minutToHoursAndMinut(timeIn);
            int timeOut = train.getStTime(chooseIndex).departure;            
            editTimeOut = minutToHoursAndMinut(timeOut);
            
            int c = massivWays[chooseIndex];
            String[] massivStringWays = new String[c];
            for(int i=0; i<c; i++){
                massivStringWays[i] = (i+1)+"";
            } 
            nameStationLabel.setText(editName);
            nameStationTextField.setText(editName);
            timeComeTextField.setText(editTimeCome);
            timeOutTextField.setText(editTimeOut);
          
            //ВЫВОД.............
            System.out.print(chooseIndex + " ");
            System.out.println(chooseStation);
            System.out.println("Command: " + e.getActionCommand());
            System.out.println(nameStationTextField.getName());
        } catch (TrainException ex) {
            Logger.getLogger(EditRoute.class.getName()).log(Level.SEVERE, null, ex);
        }
    } 
    private String minutToHoursAndMinut(int time){
        int min = time%60;
        time = time/60;
        String Time;
        if(min<10){
            Time = time+":0"+min;
        }else{
            Time = time+":"+min;
        }
        return Time;
    }
    private int hoursAndMinutToMinutes(String time){
        int result = 0;
        if(time.length() == 5){
            if(time.substring(0, 1).equals("0")){                
                int hours = Integer.parseInt(time.substring(1, 2));
                int minutes = Integer.parseInt(time.substring(2, 4));
                result = hours*60 + minutes;
            }else{
                int hours = Integer.parseInt(time.substring(0, 2));
                int minutes = Integer.parseInt(time.substring(2, 4));
                result = hours*60 + minutes;
            }
        }else{      //time.length == 4               
                int hours = Integer.parseInt(time.substring(0, 1));
                int minutes = Integer.parseInt(time.substring(2, 4));
                result = hours*60 + minutes;
        }
        return result;
    }
    private boolean find(String a){
        String massiv = "0123456789:";
        for(int i=0; i<massiv.length(); i++){
            if(a.equals(massiv.substring(i, i+1))){
                return true;
            }  
        }
        return false;
    }
    private boolean checkTheFirstSymbol(String a){
        String massiv = "012";
        for(int i=0; i<massiv.length(); i++){
            if(a.equals(massiv.substring(i, i+1))){
                return true;
            }  
        }
        return false;
    }
    private boolean checkTheThirdSymbol(String a){
        String massiv = ":";
        for(int i=0; i<massiv.length(); i++){
            if(a.equals(massiv.substring(i, i+1))){
                return true;
            }  
        }
        return false;
    }
    private boolean checkTheForthSymbol(String a){
        String massiv = "012345:";
        for(int i=0; i<massiv.length(); i++){
            if(a.equals(massiv.substring(i, i+1))){
                return true;
            }  
        }
        return false;
    }
}

</pre>
</td>
</tr>

</table>

</body>
</html>

